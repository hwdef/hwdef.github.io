<!doctype html><html lang=zh dir=ltr><head><meta charset=utf-8><meta name=viewport content="width=device-width"><meta name=description content="夜晚，能让人呼吸。"><title>在wsl2中安装官方archlinux | 以梦喂马</title><link rel=icon href=/favicon.ico><style>:root{--accent:#ffcd00}</style><style>:root{--bg:#ffffff;--surface:#f7f7f7;--text:#263238;--muted:#6c7a86;--border:#d6dce2;--link:#1e2a32}@media(prefers-color-scheme:dark){:root{--bg:#0e141b;--surface:#121b24;--text:#e5e7eb;--muted:#9ba3af;--border:#2c3542;--link:#f5f7fa}body{color-scheme:dark}}*,*::before,*::after{box-sizing:border-box}body{margin:0;background:var(--bg);color:var(--text);font-family:-apple-system,BlinkMacSystemFont,segoe ui,Roboto,Oxygen-Sans,Ubuntu,Cantarell,open sans,helvetica neue,sans-serif;line-height:1.75;font-size:18px;color-scheme:light}a{color:var(--link);text-decoration:none;transition:color .15s ease,border-color .15s ease}a:hover,a:focus{color:var(--accent)}.site{min-height:100vh;display:flex;flex-direction:column}.container{width:100%;max-width:740px;padding:0 20px;margin:0 auto}.content-area{flex:1 0 auto;padding:0 0 2.6rem}.site-header{background:var(--bg)}.top-bar{display:flex;align-items:center;gap:1.1rem;justify-content:flex-start;padding-top:1rem;padding-bottom:.2rem;color:var(--muted);font-size:1.05rem}.brand{display:none}.main-nav ul{list-style:none;padding:0;margin:0;display:flex;gap:1.25rem;font-size:1.04rem;letter-spacing:.01em}.main-nav a{padding-bottom:.22rem;border-bottom:2px solid transparent}.main-nav a.active,.main-nav a.ancestor,.main-nav a:hover{border-bottom-color:var(--accent)}.site-hero{padding-top:.6rem;padding-bottom:1.4rem}.hero-title{margin:0 0 .4rem;font-size:2.6rem;font-weight:700;letter-spacing:.01em}.hero-desc{margin:0 0 .7rem;color:var(--muted);font-style:italic;font-size:1rem}.accent-line{display:inline-block;width:var(--date-col,6.5em);height:4px;background:var(--accent);border-radius:999px;margin:.7rem 0 .35rem;justify-self:start}.section-block{margin-top:2rem}.section-title{margin:0 0 .6rem;font-size:1.5rem;letter-spacing:.015em}.page-header{padding-top:.6rem;padding-bottom:1.4rem}.page-title{margin:0 0 .4rem;font-size:2.6rem;font-weight:700;letter-spacing:.01em}.page-desc{margin:0 0 .7rem;color:var(--muted);font-style:italic;font-size:1rem}.home-wrap{--date-col:6.5em;--col-gap:1rem;display:grid;grid-template-columns:var(--date-col)1fr;grid-column-gap:var(--col-gap);row-gap:.6rem}.home-wrap .hero-title,.home-wrap .hero-desc{grid-column:1/-1}.home-wrap .hero-line{grid-column:1/2;margin-top:.6rem;justify-self:start}.home-wrap .section-title{grid-column:1/-1;margin-top:.8rem}.home-wrap .post-list{grid-column:1/-1}.home-wrap .posts-line{grid-column:1/2;margin-top:.8rem;justify-self:start}.post-list{list-style:none;padding:0;margin:.8rem 0 0;display:grid;grid-template-columns:var(--date-col,6.5em)1fr;grid-column-gap:var(--col-gap,.9rem);grid-row-gap:.75rem}.post-list-item{display:contents}.post-date{color:var(--muted);font-size:1.02rem;min-width:0;display:block}.post-link{font-weight:600;font-size:1.12rem}.entry{margin-top:2rem}.entry-header{padding:2rem 0 1.25rem;border-bottom:2px solid var(--border)}.entry-title{margin:0;font-size:2rem;line-height:1.2}.entry-meta{margin-top:.5rem;color:var(--muted);font-style:italic;display:flex;align-items:center;gap:.5rem;font-size:.95rem}.meta-divider{color:var(--border)}.entry-content{margin-top:2rem}.entry-content p{margin:0 0 1.4rem}.entry-content h2,.entry-content h3,.entry-content h4,.entry-content h5,.entry-content h6{margin-top:2rem;margin-bottom:.75rem}.entry-content blockquote{margin:1.5rem 0;padding-left:1rem;border-left:4px solid var(--border);color:var(--muted);font-style:italic}.entry-content code{background:var(--surface);padding:.15rem .35rem;border-radius:4px;border:1px solid var(--border);font-size:.95em;font-family:Menlo,Consolas,Monaco,Ubuntu Mono,liberation mono,monospace}.entry-content pre{background:var(--surface);border:1px solid var(--border);border-radius:8px;padding:1rem;overflow-x:auto}.entry-content pre code{background:0 0;padding:0;border:0}.entry-content ul,.entry-content ol{padding-left:1.2rem;margin:0 0 1.4rem}.entry-content img{max-width:100%;height:auto;display:block;margin:1.25rem auto}.entry-content table{width:100%;border-collapse:collapse;margin:1.5rem 0;border:1px solid var(--border)}.entry-content th,.entry-content td{border:1px solid var(--border);padding:.5rem .75rem;text-align:left}.entry-tags{display:flex;flex-wrap:wrap;gap:.5rem;margin:2rem 0 0;padding-top:1rem;border-top:1px solid var(--border)}.entry-tags a{border:1px solid var(--border);background:var(--surface);padding:.3rem .75rem;border-radius:999px;font-size:.9rem;color:var(--link)}.entry-nav{display:flex;justify-content:space-between;gap:1rem;margin:2.5rem 0 0;padding-top:1rem;border-top:1px solid var(--border)}.nav-link{font-weight:600}.pagination{display:flex;align-items:center;gap:.4rem;margin:2rem 0;flex-wrap:wrap}.page-link{border:1px solid var(--border);padding:.4rem .7rem;border-radius:.4rem;font-size:.95rem}.page-link.active{background:var(--link);color:var(--bg);border-color:var(--link)}.taxonomy-list{list-style:none;padding:0;margin:2rem 0 0;display:grid;gap:.5rem}.taxonomy-list li{display:flex;justify-content:space-between;border:1px solid var(--border);border-radius:.5rem;padding:.65rem .85rem;background:var(--surface)}.term-count{color:var(--muted)}.site-footer{padding:1.5rem 0 2.3rem;background:var(--bg);margin-top:auto}.social-links{display:flex;gap:.85rem;flex-wrap:wrap;margin:.75rem 0}.social-links a{width:auto;height:auto;display:inline-flex;align-items:center;justify-content:center;color:var(--link)}.social-links svg{width:1.25rem;height:1.25rem;stroke:currentColor;fill:none;stroke-width:2}.copyright{color:var(--muted);font-size:.95rem}@media(max-width:640px){.main-nav ul{flex-wrap:wrap;gap:.6rem 1.1rem}.post-list-item{flex-direction:column;align-items:flex-start}.post-date{min-width:auto}.entry-nav{flex-direction:column}}</style><link rel=stylesheet href=/css/custom.css></head><body class="page section-post"><div class=site><header class=site-header><div class="container top-bar"><nav class=main-nav aria-label="Main navigation"><ul><li><a href=/>主页</a></li><li><a href=/post/>文章</a></li><li><a href=/tags/>标签</a></li><li><a href=/resume/>简历</a></li><li><a href=/about/>关于</a></li></ul></nav></div></header><main id=content class=content-area><article class="entry container"><header class=entry-header><h1 class=entry-title>在wsl2中安装官方archlinux</h1><div class=entry-meta><time datetime=2025-04-21T00:07:44+08:00>2025, Apr 21</time></div></header><div class=entry-content><h2 id=背景>背景</h2><p>archlinux 在最近由官方提供了对于 wsl 的支持 <a href=https://github.com/microsoft/WSL/pull/12818>https://github.com/microsoft/WSL/pull/12818</a>，此前也有在 wsl 使用 archlinux 的方式，不过都是由社区提供的一些方案，例如：https://github.com/yuk7/ArchWSL。</p><p>fedora 也在近期提供了官方对于 wsl 的支持。https://github.com/microsoft/WSL/pull/12710。这两个发行版的变化，是因为 wsl 现在可以通过一个 <code>.wsl</code> 文件提供发行版，而不需要通过 Windows 应用商店，如果上架应用商店则需要通过微软的用户条款，诸多发行版对此都有所顾虑。</p><p>既然官方提供支持了，就想体验一番，我对 wsl 是没什么意见的，体现了微软的技术实力，在有了 systemd，vscode remote插件后，使用体验还不错。</p><h2 id=安装>安装</h2><p>首先需要安装 wsl 组件，在 powershell 中运行</p><pre><code>wsl --install
</code></pre><p>需要管理员权限，安装后需要重启电脑</p><p>查看目前在线支持的版本有哪些</p><pre><code class=language-pow>wsl -l -o
以下是可安装的有效分发的列表。
使用 'wsl.exe --install &lt;Distro&gt;' 安装。

NAME                            FRIENDLY NAME
AlmaLinux-8                     AlmaLinux OS 8
AlmaLinux-9                     AlmaLinux OS 9
AlmaLinux-Kitten-10             AlmaLinux OS Kitten 10
Debian                          Debian GNU/Linux
FedoraLinux-42                  Fedora Linux 42
SUSE-Linux-Enterprise-15-SP5    SUSE Linux Enterprise 15 SP5
SUSE-Linux-Enterprise-15-SP6    SUSE Linux Enterprise 15 SP6
Ubuntu                          Ubuntu
Ubuntu-24.04                    Ubuntu 24.04 LTS
archlinux                       Arch Linux
kali-linux                      Kali Linux Rolling
openSUSE-Tumbleweed             openSUSE Tumbleweed
openSUSE-Leap-15.6              openSUSE Leap 15.6
Ubuntu-18.04                    Ubuntu 18.04 LTS
Ubuntu-20.04                    Ubuntu 20.04 LTS
Ubuntu-22.04                    Ubuntu 22.04 LTS
OracleLinux_7_9                 Oracle Linux 7.9
OracleLinux_8_7                 Oracle Linux 8.7
OracleLinux_9_1                 Oracle Linux 9.1
</code></pre><p>安装 archlinux</p><pre><code>wsl --install archlinux
正在下载: Arch Linux
正在安装: Arch Linux
已成功安装分发。它可通过 “wsl.exe -d archlinux” 启动
</code></pre><p>至此已经安装完成，但是 archlinux 什么性格大家也都懂，与其他发行版相比，安装后还需要做一些操作。但是已经比安装完整版系统少很多操作</p><h2 id=安装后操作>安装后操作</h2><p>关闭 Windows Terminal 并重新打开，在标签页下拉栏能看到 archlinux 选项，点击进入</p><p><img src=/img/image-20250420031832687.png alt=image-20250420031832687></p><p><img src=/img/image-20250420032038864.png alt=image-20250420032038864></p><p>根据官方建议，先更新</p><p>修改软件源</p><pre><code>sudo sed -i '1i Server = https://mirrors.tuna.tsinghua.edu.cn/archlinux/$repo/os/$arch\nServer = https://mirrors.bfsu.edu.cn/archlinux/$repo/os/$arch\nServer = https://mirrors.ustc.edu.cn/archlinux/$repo/os/$arch' /etc/pacman.d/mirrorlist
</code></pre><p>更新</p><pre><code>pacman -Syu
</code></pre><p>进入后默认是没有设置密码的 root 用户，首先为 root 设置密码</p><pre><code>passwd
</code></pre><p>安装必要软件</p><pre><code>pacman -S vim vi sudo
</code></pre><p>新建用户</p><pre><code>useradd -m -G wheel 你的用户名
</code></pre><p>为新用户设置密码</p><pre><code>passwd 你的用户名
</code></pre><p>配置 sudo</p><pre><code>visudo
</code></pre><p>找到 <code># %wheel ALL=(ALL)ALL</code>，去掉前面的注释#</p><p>设置默认用户，修改 <code>wsl.confg</code>添加如下内容</p><pre><code>[user]
default=你的用户名
</code></pre><p>修改 locale 设置</p><pre><code>vim /etc/locale.gen
</code></pre><p>找到 <code>en_US.UTF-8 UTF-8</code> 并取消注释这一行。</p><p>接着运行</p><pre><code>locale-gen
</code></pre><p>编辑 <code>/etc/locale.conf</code></p><p>将其中的 <code>LANG=C.UTF-8</code> 修改为 <code>LANG=en_US.UTF-8</code></p><p>关闭 archlinux 终端，在 powershell 中输入</p><pre><code>wsl --shutdown
</code></pre><p>再次打开 archlinux，可以看到用户已经变成新建的用户。</p><p>至此已经完成了基本修改，可以正常使用了，有其他需要则按需优化吧。遇到问题可以看下面的参考链接，官方的比较权威。</p><h2 id=ref>ref</h2><p><a href=https://wiki.archlinux.org/title/Install_Arch_Linux_on_WSL>https://wiki.archlinux.org/title/Install_Arch_Linux_on_WSL</a></p></div><div class=entry-tags><a href=/tags/Linux/>Linux</a></div><nav class=entry-nav><a class="nav-link prev" href=/post/whisper-ollama-ffmpeg-chinese-subtitles/>← 使用whisper+ollama+ffmpeg为视频添加中文字幕</a>
<a class="nav-link next" href=/post/why-write-blog/>为什么要写博客 →</a></nav></article></main><footer class=site-footer><div class=container><div class=social-links><a href=mailto:hwdefcom@outlook.com aria-label=Email><svg class="icon" viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" aria-hidden="true"><path d="M4 4h16c1.1.0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1.0-2-.9-2-2V6c0-1.1.9-2 2-2z"/><polyline points="22,6 12,13 2,6"/></svg>
</a><a href=https://github.com/hwdef aria-label=Github><svg class="icon" viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" aria-hidden="true"><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37.0 00-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44.0 0020 4.77 5.07 5.07.0 0019.91 1S18.73.65 16 2.48a13.38 13.38.0 00-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07.0 005 4.77 5.44 5.44.0 003.5 8.55c0 5.42 3.3 6.61 6.44 7A3.37 3.37.0 009 18.13V22"/></svg>
</a><a href=https://instagram.com/_limengyang aria-label=Instagram><svg class="icon" viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" aria-hidden="true"><rect x="2" y="2" width="20" height="20" rx="5" ry="5"/><path d="M16 11.37A4 4 0 1112.63 8 4 4 0 0116 11.37z"/><line x1="17.5" y1="6.5" x2="17.51" y2="6.5"/></svg>
</a><a href=https://t.me/hwdef aria-label=Telegram><svg class="icon" viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" aria-hidden="true"><path d="M23.91 3.79 20.3 20.84c-.25 1.21-.98 1.5-2 .94l-5.5-4.07-2.66 2.57c-.3.3-.55.56-1.1.56-.72.0-.6-.27-.84-.95L6.3 13.7.85 12c-1.18-.35-1.19-1.16.26-1.75l21.26-8.2c.97-.43 1.9.24 1.53 1.73z"/></svg></a></div><div class=copyright><p>&copy; 2018–2025 hwdef</p></div></div></footer></div></body></html>